# Jitsi setup with tokenAuthUrl

This guide is about a Jitsi setup with the following features:

- JWT based authentication on Jitsi
- There is an authentication system which generates tokens for Jitsi
- Each participant (_even guest_) has a token generated by the auth system
- Authentication flow based on `tokenAuthUrl`
- Waiting room for guest and member participants

## Installation

Assumed that Jitsi will run on Debian 12 VM. It is possible to apply the same
features on different environments.

### Basic Jitsi

Install a basic Jitsi without any customization using
[the official guide](https://jitsi.github.io/handbook/docs/devops-guide/devops-guide-quickstart).

### jitsi-meet-tokens

Install `jitsi-meet-tokens` package:

```bash
apt-get install jitsi-meet-tokens
```

### tokenAuthUrl

Set `tokenAuthUrl` in `config.js`. The link depends on how your authentication
system works:

```javascript
config.tokenAuthUrl = "https://auth.mydomain.com/auth.html?state={state}";
```

### Additional config for jitsi-meet

The following features are also set in `config.js` for our case:

```javascript
// disable the prejoin page to redirect the participant to the authentication
// system immediately if she has no token
config.prejoinConfig = {
  enabled: false,
};

// Enable autoKnock, so the participant will trigger the join attempt
// immediately when she comes to the waiting room
config.lobby = {
  autoKnock: true,
  enableChat: true,
};

// disable the lobby password
config.securityUi = {
  disableLobbyPassword: true,
};
```
